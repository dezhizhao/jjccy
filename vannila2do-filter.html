
<!DOCTYPE html>
<html lang="en" >

<head>
  <meta charset="UTF-8">
  

  


  <title>CodePen - plain-js-todo-list-with-filter-wip</title>

    <link rel="canonical" href="https://codepen.io/danigattoni/pen/VyMpJZ">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
  
<style>

body {
  font-family: "Rubik", sans-serif;
  font-size: 1.2rem;
  color: #78909c;
  background-color: #eceff1;
}

.Container {
  max-width: 60rem;
  margin: 2rem auto;
}

.Section {
  width: 100%;
  margin: 1rem 0;
}

.TodoApp {
  display: flex;
  flex-direction: column;
  align-items: center;
  font-size: 1.4rem;
}
.TodoApp-list li {
  width: 100%;
  display: flex;
  align-items: center;
  list-style: none;
}
.TodoApp-list label {
  margin-left: 0.5rem;
}

.Form {
  display: flex;
  flex-direction: column;
  width: 100%;
}
.Form-input {
  min-height: 4rem;
  margin: 1rem 0;
  padding-left: 1rem;
  font-size: 2rem;
  color: #263238;
  border: 1px solid #cfd8dc;
}

.Btn {
  height: 4rem;
  padding: 1rem;
  font-size: 1rem;
  color: #eceff1;
  background-color: #546e7a;
  border: none;
  cursor: pointer;
  transition: background-color 0.2s;
}
.Btn:hover {
  background-color: #90a4ae;
}
.Btn--link {
  margin-right: 1rem;
  color: #37474f;
  background-color: white;
}
.Btn--link:hover {
  color: orange;
  background-color: transparent;
}

.Alert {
  margin: 2rem auto;
}
.Alert--error {
  color: red;
}

input[type=checkbox]:checked + label {
  color: green;
  text-decoration: line-through;
}

.Filter {
  display: flex;
  flex-direction: row;
  justify-content: flex-end;
}
</style>


  
  
</head>

<body translate="no">
  <div class="Container TodoApp">
    <p>the goal of this codepen is to exercise my skills on plain javascript, with no extra dependencies, and also creating dynamic elements in the DOM.</p>  
  <div class="Section Filter">
      <button class="Btn Btn--link js-filter-btn" data-filter="completed">show completed</button>
      <button class="Btn Btn--link js-filter-btn" data-filter="active">show active</button>
      <button class="Btn Btn--link js-filter-btn" data-filter="all">show all</button>
  </div>
    <div class="Section">
      <form class="Form">
        <input type="text" class="Form-input js-form-input" placeholder="add your todo here..."/>
        <button class="Btn js-btn-add">add</button>
      </form>
    </div>  
  <div class="Section">
    <ul class="TodoApp-list js-todos-list"></ul>  
    <div class="Alert js-alert"></div>
  </div>
</div>



  
      <script id="rendered-js" >
const todos = [];
const todosFragment = document.createDocumentFragment();
const $todosList = document.querySelector('.js-todos-list');
const $formAddButton = document.querySelector('.js-btn-add');
const $formInput = document.querySelector('.js-form-input');
const $formMessage = document.querySelector('.js-alert');
const $FilterBtnCollection = document.querySelectorAll('.js-filter-btn');
let count = 0;

function resetForm() {
  $formInput.value = '';
  $formMessage.innerHTML = '';
  $formMessage.classList.remove('Alert--error');
}

function setTodoStatus(event) {
  const searchId = parseInt(event.target.parentNode.dataset.id);
  const index = todos.findIndex(todo => todo.id === searchId);
  const currentTodo = todos[index];
  currentTodo.complete = !currentTodo.complete;
}

function createListItemNode(todo) {
  const listItem = document.createElement('li');
  const checkbox = document.createElement('input');
  const label = document.createElement('label');
  const checkboxName = `checkbox-${todo.id}`;
  checkbox.id = checkboxName;
  checkbox.type = 'checkbox';
  checkbox.checked = todo.complete;
  checkbox.onclick = setTodoStatus;
  label.textContent = todo.text;
  label.setAttribute('for', checkboxName);
  listItem.setAttribute('data-id', todo.id);
  listItem.appendChild(checkbox);
  listItem.appendChild(label);
  return listItem;
}

function appendFragmentToList(todo, fragment) {
  const todoNode = createListItemNode(todo);
  fragment.appendChild(todoNode);
  $todosList.appendChild(fragment);
}

function addTodo(event) {
  event.preventDefault();
  if (!$formInput.value) {
    throw Error('Please add text in your task :)');
  }
  const todo = {
    id: count++,
    text: $formInput.value,
    complete: false };

  todos.push(todo);
  appendFragmentToList(todo, todosFragment);
  resetForm();
  $formInput.focus();
}

function removeAllChildNodesFrom($element) {
  while ($element.hasChildNodes()) {if (window.CP.shouldStopExecution(0)) break;
    $element.removeChild($element.lastChild);
  }window.CP.exitedLoop(0);
}

function filterList(todos, fragment, filterCallback) {
  todos.filter(filterCallback).
  forEach(filteredTodo => appendFragmentToList(filteredTodo, todosFragment));
}

/* Event Listeners */
$formAddButton.addEventListener('click', e => {
  try {
    console.time("js addTodo");
    addTodo(e);
    console.timeEnd("js addTodo");
  } catch (error) {
    $formMessage.classList.add('Alert--error');
    $formMessage.innerHTML = error.message;
  }
});

$FilterBtnCollection.forEach($filterBtn => {
  $filterBtn.addEventListener('click', event => {
    const filter = event.target.dataset.filter || 'all';
    removeAllChildNodesFrom($todosList);
    switch (filter) {
      case 'completed':
        filterList(todos, todosFragment, todo => todo.complete);
        break;
      case 'active':
        filterList(todos, todosFragment, todo => !todo.complete);
        break;
      default:
        filterList(todos, todosFragment, todo => todo);}

  });
});
    </script>
<SCript>
    window.HUB_EVENTS={ASSET_ADDED:"ASSET_ADDED",ASSET_DELETED:"ASSET_DELETED",ASSET_DESELECTED:"ASSET_DESELECTED",ASSET_SELECTED:"ASSET_SELECTED",ASSET_UPDATED:"ASSET_UPDATED",CONSOLE_CHANGE:"CONSOLE_CHANGE",CONSOLE_CLOSED:"CONSOLE_CLOSED",CONSOLE_EVENT:"CONSOLE_EVENT",CONSOLE_OPENED:"CONSOLE_OPENED",CONSOLE_RUN_COMMAND:"CONSOLE_RUN_COMMAND",CONSOLE_SERVER_CHANGE:"CONSOLE_SERVER_CHANGE",EMBED_ACTIVE_PEN_CHANGE:"EMBED_ACTIVE_PEN_CHANGE",EMBED_ACTIVE_THEME_CHANGE:"EMBED_ACTIVE_THEME_CHANGE",EMBED_ATTRIBUTE_CHANGE:"EMBED_ATTRIBUTE_CHANGE",EMBED_RESHOWN:"EMBED_RESHOWN",FORMAT_FINISH:"FORMAT_FINISH",FORMAT_ERROR:"FORMAT_ERROR",FORMAT_START:"FORMAT_START",IFRAME_PREVIEW_RELOAD_CSS:"IFRAME_PREVIEW_RELOAD_CSS",IFRAME_PREVIEW_URL_CHANGE:"IFRAME_PREVIEW_URL_CHANGE",KEY_PRESS:"KEY_PRESS",LINTER_FINISH:"LINTER_FINISH",LINTER_START:"LINTER_START",PEN_CHANGE_SERVER:"PEN_CHANGE_SERVER",PEN_CHANGE:"PEN_CHANGE",PEN_EDITOR_CLOSE:"PEN_EDITOR_CLOSE",PEN_EDITOR_CODE_FOLD:"PEN_EDITOR_CODE_FOLD",PEN_EDITOR_ERRORS:"PEN_EDITOR_ERRORS",PEN_EDITOR_EXPAND:"PEN_EDITOR_EXPAND",PEN_EDITOR_FOLD_ALL:"PEN_EDITOR_FOLD_ALL",PEN_EDITOR_LOADED:"PEN_EDITOR_LOADED",PEN_EDITOR_REFRESH_REQUEST:"PEN_EDITOR_REFRESH_REQUEST",PEN_EDITOR_RESET_SIZES:"PEN_EDITOR_RESET_SIZES",PEN_EDITOR_SIZES_CHANGE:"PEN_EDITOR_SIZES_CHANGE",PEN_EDITOR_UI_CHANGE_SERVER:"PEN_EDITOR_UI_CHANGE_SERVER",PEN_EDITOR_UI_CHANGE:"PEN_EDITOR_UI_CHANGE",PEN_EDITOR_UI_DISABLE:"PEN_EDITOR_UI_DISABLE",PEN_EDITOR_UI_ENABLE:"PEN_EDITOR_UI_ENABLE",PEN_EDITOR_UNFOLD_ALL:"PEN_EDITOR_UNFOLD_ALL",PEN_ERROR_INFINITE_LOOP:"PEN_ERROR_INFINITE_LOOP",PEN_ERROR_RUNTIME:"PEN_ERROR_RUNTIME",PEN_ERRORS:"PEN_ERRORS",PEN_LIVE_CHANGE:"PEN_LIVE_CHANGE",PEN_LOGS:"PEN_LOGS",PEN_MANIFEST_CHANGE:"PEN_MANIFEST_CHANGE",PEN_MANIFEST_FULL:"PEN_MANIFEST_FULL",PEN_PREVIEW_FINISH:"PEN_PREVIEW_FINISH",PEN_PREVIEW_START:"PEN_PREVIEW_START",PEN_SAVED:"PEN_SAVED",POPUP_CLOSE:"POPUP_CLOSE",POPUP_OPEN:"POPUP_OPEN",POST_CHANGE:"POST_CHANGE",POST_SAVED:"POST_SAVED",PROCESSING_FINISH:"PROCESSING_FINISH",PROCESSING_START:"PROCESSED_STARTED"},"object"!=typeof window.CP&&(window.CP={}),window.CP.PenTimer={programNoLongerBeingMonitored:!1,timeOfFirstCallToShouldStopLoop:0,_loopExits:{},_loopTimers:{},START_MONITORING_AFTER:2e3,STOP_ALL_MONITORING_TIMEOUT:5e3,MAX_TIME_IN_LOOP_WO_EXIT:2200,exitedLoop:function(E){this._loopExits[E]=!0},shouldStopLoop:function(E){if(this.programKilledSoStopMonitoring)return!0;if(this.programNoLongerBeingMonitored)return!1;if(this._loopExits[E])return!1;var _=this._getTime();if(0===this.timeOfFirstCallToShouldStopLoop)return this.timeOfFirstCallToShouldStopLoop=_,!1;var o=_-this.timeOfFirstCallToShouldStopLoop;if(o<this.START_MONITORING_AFTER)return!1;if(o>this.STOP_ALL_MONITORING_TIMEOUT)return this.programNoLongerBeingMonitored=!0,!1;try{this._checkOnInfiniteLoop(E,_)}catch{return this._sendErrorMessageToEditor(),this.programKilledSoStopMonitoring=!0,!0}return!1},_sendErrorMessageToEditor:function(){try{if(this._shouldPostMessage()){var E={topic:HUB_EVENTS.PEN_ERROR_INFINITE_LOOP,data:{line:this._findAroundLineNumber()}};parent.postMessage(E,"*")}else this._throwAnErrorToStopPen()}catch{this._throwAnErrorToStopPen()}},_shouldPostMessage:function(){return document.location.href.match(/boomboom/)},_throwAnErrorToStopPen:function(){throw"We found an infinite loop in your Pen. We've stopped the Pen from running. More details and workarounds at https://blog.codepen.io/2016/06/08/can-adjust-infinite-loop-protection-timing/"},_findAroundLineNumber:function(){var E=new Error("ignored"),_=0;if(E.stack){var o=E.stack.match(/boomboom\S+:(\d+):\d+/);o&&(_=o[1])}return _},_checkOnInfiniteLoop:function(E,_){if(!this._loopTimers[E])return this._loopTimers[E]=_,!1;if(_-this._loopTimers[E]>this.MAX_TIME_IN_LOOP_WO_EXIT)throw"Infinite Loop found on loop: "+E},_getTime:function(){return Date.now()}},window.CP.shouldStopExecution=function(E){var _=window.CP.PenTimer.shouldStopLoop(E);return!0===_&&console.warn("[CodePen]: An infinite loop (or a loop taking too long) was detected, so we stopped its execution. More details at https://blog.codepen.io/2016/06/08/can-adjust-infinite-loop-protection-timing/"),_},window.CP.exitedLoop=function(E){window.CP.PenTimer.exitedLoop(E)};
</SCript>
  
</body>

</html>
